
(function(compId){var _=null,y=true,n=false,x32='break-word',x25='271px',x64='25px',x51='5.4%',x31='700',x22='rgb(0, 0, 0)',x27='65px',e7='${progress_status}',x50='95%',x16='12px',x46='rgba(5,17,99,1)',x9='-2px',x70='status_txt',x56='rgb(204, 204, 204)',x23='rgba(255,255,255,1.00)',x52='1.5%',d='display',x59='0.1%',i='none',x21='photo',x26='266px',x3='6.0.0.400',lf='left',x45='Tahoma, Geneva, sans-serif',x62='rgba(41,128,185,1.00)',x54='26.5%',x36='292px',x40='99.6%',x13='auto',x24='11px',x37='0.2%',x5='rgba(255,255,255,1)',tp='top',x11='294px',x69='400',xc='rgba(0,0,0,1)',x65='400px',x42='rgba(200,209,243,1)',x1='6.0.0',x47='nowrap',x30='rgba(5,17,99,1.00)',x2='5.0.0',x43='33%',x66='27px',x44='18.6%',po='center',x19='73.8%',x38='0%',e73='${status_txt}',x35='true',x41='order_btn_bg',x20='10px',x='text',x57='solid',m='rect',x12='340px',h='height',x29='em',fs='font-size',x18='265px',rt='right',e74='${progress_fg}',x72='5.3%',x68='rgba(41,128,185,1)',e6='${order_btn}',x67='average, sans-serif',x63='1px',x15='rgba(200,209,243,1.00)',x61='progress_fg',x60='4.4%',l='normal',x58='rgba(213,223,232,1.00)',x48='order_btn_txt',x53='99.5%',x28='acme, sans-serif',x39='100%',w='width',x4='both',x14='menu_bg',x17='9px',x10='0px',x55='progress_bg',x33='title',e8='${menu}';var s49="<p style=\"margin: 0px;\">​Select Drinks</p>",s71="<p style=\"margin: 0px; text-indent: 0%;\">​<span style=\"font-family: Tahoma, Geneva, sans-serif; font-size: 90%; word-spacing: 0em; letter-spacing: 0em; font-weight: 500;\">YujinRobot&nbsp;Smart cafe&nbsp;</span></p>",s34="<p style=\"margin: 0px;\">​title</p>";var im='images/',aud='media/',vid='media/',js='js/',fonts={'bebas-neue, sans-serif':'<script src=\"http://use.edgefonts.net/bebas-neue:n4:all.js\"></script>','average, sans-serif':'<script src=\"http://use.edgefonts.net/average:n4:all.js\"></script>','acme, sans-serif':'<script src=\"http://use.edgefonts.net/acme:n4:all.js\"></script>'},opts={'gAudioPreloadPreference':'auto','gVideoPreloadPreference':'auto'},resources=[],scripts=["includes/jquery-1.7.1.min.js"],symbols={"stage":{v:x1,mv:x2,b:x3,stf:x4,cg:x4,rI:n,cn:{dom:[{id:'menu',symbolName:'menu',v:i,t:m,r:['9px','10px','260','270','auto','auto'],overflow:'visible'},{id:'order_btn',symbolName:'order_btn',t:m,r:['16px','73px','688px','69','auto','auto']},{id:'progress_status',symbolName:'progress_status',t:m,r:['auto','0%','720px','68','-0.4%','auto']}],style:{'${Stage}':{isStage:true,r:['null','null','720px','1280px','auto','auto'],overflow:'hidden',f:[x5]}}},tt:{d:1000,a:y,data:[["eid109",lf,0,0,"linear",e6,'16px','16px'],["eid121",w,0,0,"linear",e7,'720px','720px'],["eid5",tp,0,0,"linear",e8,'10px','10px'],["eid4",lf,0,0,"linear",e8,'9px','9px'],["eid127",rt,0,1000,"linear",e7,'-0.42%','0%'],["eid123",tp,0,0,"linear",e6,'73px','73px'],["eid112",w,0,0,"linear",e6,'688px','688px'],["eid6",d,0,0,"linear",e8,i,i],["eid115",tp,0,0,"linear",e7,'0%','0%']]}},"menu":{v:x1,mv:x2,b:x3,stf:i,cg:i,rI:y,cn:{dom:[{r:[x9,x10,x11,x12,x13,x13],id:x14,s:[0,xc,i],t:m,f:[x15]},{r:[x16,x17,x18,x19,x13,x13],br:[x20,x20,x20,x20],id:x21,s:[0,x22,i],t:m,f:[x23]},{r:[x24,x25,x26,x27,x13,x13],ts:['','','','',i],n:[x28,[2.81,x29],x30,x31,i,l,x32,''],id:x33,text:s34,align:po,t:x}],style:{'${symbolSelector}':{isStage:x35,r:[undefined,undefined,x36,x12]}}},tt:{d:0,a:y,data:[]}},"order_btn":{v:x1,mv:x2,b:x3,stf:i,cg:i,rI:y,cn:{dom:[{r:[x37,x38,x39,x40,x13,x13],br:[x20,x20,x20,x20],id:x41,s:[0,x22,i],t:m,f:[x42]},{r:[x43,x44,x13,x13,x13,x13],ts:['','','','',i],n:[x45,[2.19,x29],x46,x31,i,l,x32,x47],id:x48,text:s49,align:po,t:x}],style:{'${symbolSelector}':{isStage:x35,r:[undefined,undefined,x50,x51]}}},tt:{d:0,a:y,data:[]}},"progress_status":{v:x1,mv:x2,b:x3,stf:i,cg:i,rI:y,cn:{dom:[{r:[x38,x52,x53,x54,x13,x13],id:x55,s:[2,x56,x57],t:m,f:[x58]},{r:[x59,x60,x39,x54,x13,x13],id:x61,s:[2,x56,i],t:m,f:[x62]},{r:[x63,x64,x65,x66,x13,x13],ts:['','','','',i],n:[x67,[1.88,x29],x68,x69,i,l,x32,''],id:x70,text:s71,align:lf,t:x}],style:{'${symbolSelector}':{isStage:x35,r:[undefined,undefined,x39,x72]}}},tt:{d:1000,a:y,data:[["eid80",h,0,0,"linear",e73,'27px','27px'],["eid86",tp,0,0,"linear",e73,'25px','25px'],["eid102",w,0,1000,"linear",e74,'0%','100%'],["eid83",w,0,0,"linear",e73,'400px','400px'],["eid119",fs,0,0,"linear",e73,'1.88em','1.88em'],["eid126",h,1000,0,"linear",e74,'26.47%','26.47%'],["eid82",lf,0,0,"linear",e73,'1px','1px']]}}};AdobeEdge.registerCompositionDefn(compId,symbols,fonts,scripts,resources,opts);})("EDGE-67918046");
(function($,Edge,compId){var Composition=Edge.Composition,Symbol=Edge.Symbol;Edge.registerEventBinding(compId,function($){
//Edge symbol: 'stage'
(function(symbolName){var ros;var deliver_order_client;Symbol.bindElementAction(compId,symbolName,"document","compositionReady",function(sym,e){console.log("menu.json loaded");var menu_data;var arr=new Array();sym.setVariable("menuArray",arr);$.getJSON('menu.json',function(menu_data){console.log("menu list size :"+menu_data.length);var compId=sym.getComposition().getCompId();for(var i=0;i<menu_data.length;i++){var s=sym.createChildSymbol("menu","Stage");s.setVariable("id",i);s.setVariable("name",menu_data[i].title);s.setVariable("qty",0);s.$("photo").css({"background-image":"url('"+menu_data[i].image+"')"});s.$("title").html(s.getVariable("name"));s.getSymbolElement().css({"float":"left","margin":"10px","top":"13%","left":"50px"});arr.push(s);}
arr.forEach(function(symbolInTheArray){var menuItem=$(symbolInTheArray);var menuElement=$(symbolInTheArray.getSymbolElement());menuElement.bind("click",function(){var qty=symbolInTheArray.getVariable("qty");if(qty<2){qty=qty+1;}else{qty=0;}
symbolInTheArray.setVariable("qty",qty);var div=symbolInTheArray.$("menu_bg")[0];if(qty>0){symbolInTheArray.$("title").html(symbolInTheArray.getVariable("name")+"  Qty: "+qty.toString());symbolInTheArray.$("title").css("color","white");div.style.backgroundColor="#3c5dd4";}
else{div.style.backgroundColor="#c8d1f3";symbolInTheArray.$("title").css("color","#051163");symbolInTheArray.$("title").html(symbolInTheArray.getVariable("name"));}
update_order_msg();});});ros.connect(sym.getVariable("master_url"));});function update_order_msg(){if(typeof arr=="undefined"){console.log("stored menu array is undefined");return false;}
else{var total_qty=0;var menus=""
for(var i=0;i<arr.length;i++){var order_in_array=arr[i];var temp_qty=order_in_array.getVariable("qty");total_qty=total_qty+temp_qty;if(temp_qty>0)
menus=menus+order_in_array.getVariable("name")+":"+temp_qty.toString()+",";}
sym.setVariable("total_qty",total_qty);sym.setVariable("menus",menus);if(total_qty>0){sym.getSymbol("order_btn").$("order_btn_txt").html("Order");sym.getSymbol("order_btn").$("order_btn_txt").css("color","white");sym.getSymbol("order_btn").$("order_btn_bg")[0].style.backgroundColor="#3c5dd4";}
else{sym.getSymbol("order_btn").$("order_btn_txt").html("Select");sym.getSymbol("order_btn").$("order_btn_txt").css("color","#3c5dd4");sym.getSymbol("order_btn").$("order_btn_bg")[0].style.backgroundColor="#c8d1f3";}
console.log("Total:"+total_qty.toString(10));console.log(menus);return true;}};});
//Edge binding end
Symbol.bindSymbolAction(compId,symbolName,"creationComplete",function(sym,e){console.log("Loading ROS libraries");ros=new ROSLIB.Ros();console.log("remapping rules setting");var send_order_pub="send_order";var send_order_pub_type="simple_delivery_msgs/DeliveryOrder";var delivery_status_sub_topic="delivery_status";var delivery_status_sub_type="simple_delivery_msgs/DeliveryStatus";var defaultUrL="";var receiver_location="";sym.setVariable("order_progressing",false);if(rocon_interactions.hasOwnProperty('rosbridge_uri')){defaultUrL=rocon_interactions.rosbridge_uri;}else{defaultUrL='localhost';}
sym.setVariable("master_url",defaultUrL);console.log("defaultUrL : "+defaultUrL);if(rocon_interactions.parameters.hasOwnProperty('extra_data')){receiver_location=rocon_interactions.parameters.extra_data;}
else{console.log("extra_data(receiver_location) is not set");}
sym.setVariable("receiver_location",receiver_location);console.log(rocon_interactions.parameters);if(send_order_pub in rocon_interactions.remappings)
send_order_pub=rocon_interactions.remappings[send_order_pub];console.log(send_order_pub);if(delivery_status_sub_topic in rocon_interactions.remappings)
delivery_status_sub_topic=rocon_interactions.remappings[delivery_status_sub_topic];console.log(delivery_status_sub_topic);settingROSCallbacks();function settingROSCallbacks()
{ros.on('connection',function(){console.log("Connected");deliver_order_client=new ROSLIB.Topic({ros:ros,name:send_order_pub,messageType:send_order_pub_type});var delivery_status_listener=new ROSLIB.Topic({ros:ros,name:delivery_status_sub_topic,messageType:delivery_status_sub_type});delivery_status_listener.subscribe(processDeliveryStatusUpdate);});ros.on('error',function(e){console.log("Error!",e);});ros.on('close',function(){console.log("Connection Close!");});};function processDeliveryStatusUpdate(data){var current_order_id=sym.getVariable("order_id");if(data.order_id==current_order_id){switch(data.status)
{case 10:sym.getSymbol("progress_status").play();sym.getSymbol("progress_status").$("status_txt").html("YujinRobot Smart Cafe");break;case 20:sym.getSymbol("progress_status").stop(110);sym.getSymbol("progress_status").$("status_txt").html("Robot is going to frontdesk");break;case 30:sym.getSymbol("progress_status").stop(220);sym.getSymbol("progress_status").$("status_txt").html("Arrived at frontdesk");break;case 40:sym.getSymbol("progress_status").stop(330);sym.getSymbol("progress_status").$("status_txt").html("Preparing ordered drink");break;case 51:sym.getSymbol("progress_status").stop(440);sym.getSymbol("progress_status").$("status_txt").html("Robot is going to receiver");break;case 52:sym.getSymbol("progress_status").stop(550);sym.getSymbol("progress_status").$("status_txt").html("Arrived at receiver");break;case 53:sym.getSymbol("progress_status").stop(660);sym.getSymbol("progress_status").$("status_txt").html("Take your order and press robot's green button");break;case 54:sym.getSymbol("progress_status").stop(770);sym.getSymbol("progress_status").$("status_txt").html("Delivery complete");break;case 70:sym.getSymbol("progress_status").stop(880);sym.getSymbol("progress_status").$("status_txt").html("Return to dock");break;case 80:sym.getSymbol("progress_status").stop(1000);sym.getSymbol("progress_status").$("status_txt").html("Return complete");sym.getSymbol("order_btn").$("order_btn_bg")[0].style.backgroundColor="#3c5dd4";sym.setVariable("order_progressing",false);break;case-10:sym.getSymbol("progress_status").stop(110);sym.getSymbol("progress_status").$("status_txt").html("Error");break;}}
else{console.log('other delivery status');console.log(current_order_id);console.log(data.order_id);}};});
//Edge binding end
Symbol.bindElementAction(compId,symbolName,"${order_btn}","click",function(sym,e){var qty=sym.getVariable("total_qty");if(typeof qty!="undefined"){console.log("total qty:"+qty.toString());if(qty>0&&sym.getVariable("order_progressing")==false){var menus=[];menus.push(sym.getVariable("menus"));var order_id=uuid();sym.setVariable("order_id",order_id);var target=sym.getVariable("receiver_location");var order=new ROSLIB.Message({order_id:order_id,receivers:[{'location':target,'qty':qty,'menus':menus}]});console.log("send order");console.log(order);deliver_order_client.publish(order);sym.setVariable("order_progressing",true);sym.getSymbol("order_btn").$("order_btn_bg")[0].style.backgroundColor="#c8d1f3";sym.getSymbol("progress_status").$("status_txt").html("Order received.");}}
else{console.log("qty is undefined");}});
//Edge binding end
})("stage");
//Edge symbol end:'stage'

//=========================================================

//Edge symbol: 'menu'
(function(symbolName){})("menu");
//Edge symbol end:'menu'

//=========================================================

//Edge symbol: 'order_btn'
(function(symbolName){})("order_btn");
//Edge symbol end:'order_btn'

//=========================================================

//Edge symbol: 'progress_status'
(function(symbolName){})("progress_status");
//Edge symbol end:'progress_status'
})})(AdobeEdge.$,AdobeEdge,"EDGE-67918046");