
(function(compId){var _=null,y=true,n=false,x27='break-word',x55='25px',x26='700',x20='rgb(0, 0, 0)',x44='69px',x51='rgba(213,223,232,1.00)',x37='rgba(5,17,99,1)',x61='status_txt',x32='99.8%',x9='260px',x28='title',d='display',i='none',x19='photo',x59='rgba(41,128,185,1)',x3='6.0.0.400',lf='left',x36='Tahoma, Geneva, sans-serif',x54='rgba(41,128,185,1.00)',x33='99.6%',x11='auto',e7='${menu}',x5='rgba(255,255,255,1)',x10='270px',x42='32.1%',xc='rgba(0,0,0,1)',x56='400px',x35='rgba(200,209,243,1)',x1='6.0.0',x38='nowrap',x25='rgba(5,17,99,1.00)',x46='396px',x57='27px',x4='both',x15='9px',x31='0%',e65='${status_txt}',x30='true',x34='order_btn_bg',x18='10px',x='text',x52='3px',x50='solid',m='rect',x8='0px',h='height',x41='16.7%',x23='28px',fs='font-size',e66='${progress_fg}',p='px',w='width',x64='68px',x63='401px',x16='246px',e6='${order_btn}',x60='400',x58='average, sans-serif',x13='rgba(200,209,243,1.00)',x53='progress_fg',x2='5.0.0',l='normal',po='center',x39='order_btn_txt',x43='227px',x45='1px',x24='acme, sans-serif',x49='rgb(204, 204, 204)',x17='221px',x14='6px',x12='menu_bg',x47='18px',x48='progress_bg',x21='rgba(255,255,255,1.00)',x22='234px',tp='top';var s40="<p style=\"margin: 0px;\">​Select Drinks</p>",s29="<p style=\"margin: 0px;\">​title</p>",s62="<p style=\"margin: 0px; text-indent: 0%;\">​<span style=\"font-family: Tahoma, Geneva, sans-serif; font-size: 90%; word-spacing: 0em; letter-spacing: 0em; font-weight: 500;\">YujinRobot&nbsp;Smart cafe&nbsp;</span></p>";var im='images/',aud='media/',vid='media/',js='js/',fonts={'bebas-neue, sans-serif':'<script src=\"http://use.edgefonts.net/bebas-neue:n4:all.js\"></script>','average, sans-serif':'<script src=\"http://use.edgefonts.net/average:n4:all.js\"></script>','acme, sans-serif':'<script src=\"http://use.edgefonts.net/acme:n4:all.js\"></script>'},opts={'gAudioPreloadPreference':'auto','gVideoPreloadPreference':'auto'},resources=[],scripts=["includes/jquery-1.7.1.min.js"],symbols={"stage":{v:x1,mv:x2,b:x3,stf:x4,cg:x4,rI:n,cn:{dom:[{id:'menu',symbolName:'menu',v:i,t:m,r:['9px','10px','260','270','auto','auto'],overflow:'visible'},{id:'order_btn',symbolName:'order_btn',t:m,r:['6px','27px','227','69','auto','auto']},{id:'progress_status',symbolName:'progress_status',t:m,r:['auto','2.3%','401','68','10.7%','auto']}],style:{'${Stage}':{isStage:true,r:['null','null','720px','1280px','auto','auto'],overflow:'hidden',f:[x5]}}},tt:{d:0,a:y,data:[["eid12",lf,0,0,"linear",e6,'6px','6px'],["eid5",tp,0,0,"linear",e7,'10px','10px'],["eid4",lf,0,0,"linear",e7,'9px','9px'],["eid8",tp,0,0,"linear",e6,'27px','27px'],["eid6",d,0,0,"linear",e7,i,i]]}},"menu":{v:x1,mv:x2,b:x3,stf:i,cg:i,rI:n,cn:{dom:[{r:[x8,x8,x9,x10,x11,x11],id:x12,s:[0,xc,i],t:m,f:[x13]},{r:[x14,x15,x16,x17,x11,x11],br:[x18,x18,x18,x18],id:x19,s:[0,x20,i],t:m,f:[x21]},{r:[x14,x22,x16,x23,x11,x11],ts:['','','','',i],n:[x24,[24,p],x25,x26,i,l,x27,''],id:x28,text:s29,align:po,t:x}],style:{'${symbolSelector}':{isStage:x30,r:[undefined,undefined,x9,x10]}}},tt:{d:0,a:y,data:[]}},"order_btn":{v:x1,mv:x2,b:x3,stf:i,cg:i,rI:n,cn:{dom:[{r:[x31,x31,x32,x33,x11,x11],br:[x18,x18,x18,x18],id:x34,s:[0,x20,i],t:m,f:[x35]},{n:[x36,[24,p],x37,x26,i,l,x27,x38],t:x,align:po,id:x39,ts:['','','','',i],text:s40,r:[x41,x42,x11,x11,x11,x11]}],style:{'${symbolSelector}':{r:[_,_,x43,x44]}}},tt:{d:0,a:y,data:[]}},"progress_status":{v:x1,mv:x2,b:x3,stf:i,cg:i,rI:n,cn:{dom:[{r:[x8,x45,x46,x47,x11,x11],id:x48,s:[2,x49,x50],t:m,f:[x51]},{r:[x45,x52,x8,x47,x11,x11],id:x53,s:[2,x49,i],t:m,f:[x54]},{r:[x45,x55,x56,x57,x11,x11],ts:['','','','',i],n:[x58,[25,p],x59,x60,i,l,x27,''],id:x61,text:s62,align:lf,t:x}],style:{'${symbolSelector}':{isStage:x30,r:[undefined,undefined,x63,x64]}}},tt:{d:1000,a:y,data:[["eid86",tp,0,0,"linear",e65,'25px','25px'],["eid102",w,0,1000,"linear",e66,'0px','396px'],["eid83",w,0,0,"linear",e65,'400px','400px'],["eid88",fs,0,0,"linear",e65,'25px','25px'],["eid80",h,0,0,"linear",e65,'27px','27px'],["eid82",lf,0,0,"linear",e65,'1px','1px']]}}};AdobeEdge.registerCompositionDefn(compId,symbols,fonts,scripts,resources,opts);})("EDGE-67918046");
(function($,Edge,compId){var Composition=Edge.Composition,Symbol=Edge.Symbol;Edge.registerEventBinding(compId,function($){
//Edge symbol: 'stage'
(function(symbolName){var ros;var deliver_order_client;Symbol.bindElementAction(compId,symbolName,"document","compositionReady",function(sym,e){console.log("menu.json loaded");var menu_data;var arr=new Array();sym.setVariable("menuArray",arr);$.getJSON('menu.json',function(menu_data){console.log("menu list size :"+menu_data.length);var compId=sym.getComposition().getCompId();for(var i=0;i<menu_data.length;i++){var s=sym.createChildSymbol("menu","Stage");s.setVariable("id",i);s.setVariable("name",menu_data[i].title);s.setVariable("qty",0);s.$("photo").css({"background-image":"url('"+menu_data[i].image+"')"});s.$("title").html(s.getVariable("name"));s.getSymbolElement().css({"float":"left","margin":"10px","top":"100px","left":"50px"});arr.push(s);}
arr.forEach(function(symbolInTheArray){var menuItem=$(symbolInTheArray);var menuElement=$(symbolInTheArray.getSymbolElement());menuElement.bind("click",function(){var qty=symbolInTheArray.getVariable("qty");if(qty<3){qty=qty+1;}else{qty=0;}
symbolInTheArray.setVariable("qty",qty);var div=symbolInTheArray.$("menu_bg")[0];if(qty>0){symbolInTheArray.$("title").html(symbolInTheArray.getVariable("name")+"  Qty: "+qty.toString());div.style.backgroundColor="#3c5dd4";}
else{div.style.backgroundColor="#c8d1f3";symbolInTheArray.$("title").html(symbolInTheArray.getVariable("name"));}
update_order_msg();});});ros.connect(sym.getVariable("master_url"));});function update_order_msg(){if(typeof arr=="undefined"){console.log("stored menu array is undefined");return false;}
else{var total_qty=0;var menus=""
for(var i=0;i<arr.length;i++){var order_in_array=arr[i];var temp_qty=order_in_array.getVariable("qty");total_qty=total_qty+temp_qty;if(temp_qty>0)
menus=menus+order_in_array.getVariable("name")+":"+temp_qty.toString()+",";}
sym.setVariable("total_qty",total_qty);sym.setVariable("menus",menus);if(total_qty>0){sym.getSymbol("order_btn").$("order_btn_txt").html("Order");sym.getSymbol("order_btn").$("order_btn_txt").css("color","white");sym.getSymbol("order_btn").$("order_btn_bg")[0].style.backgroundColor="#3c5dd4";}
else{sym.getSymbol("order_btn").$("order_btn_txt").html("Select");sym.getSymbol("order_btn").$("order_btn_txt").css("color","#3c5dd4");sym.getSymbol("order_btn").$("order_btn_bg")[0].style.backgroundColor="#c8d1f3";}
console.log("Total:"+total_qty.toString(10));console.log(menus);return true;}};});
//Edge binding end
Symbol.bindSymbolAction(compId,symbolName,"creationComplete",function(sym,e){console.log("Loading ROS libraries");ros=new ROSLIB.Ros();console.log("remapping rules setting");var send_order_pub="send_order";var send_order_pub_type="simple_delivery_msgs/DeliveryOrder";var delivery_status_sub_topic="delivery_status";var delivery_status_sub_type="simple_delivery_msgs/DeliveryStatus";var defaultUrL="";sym.setVariable("order_progressing",false);if(rocon_interactions.hasOwnProperty('rosbridge_uri')){defaultUrL=rocon_interactions.rosbridge_uri;}else{defaultUrL='localhost';}
sym.setVariable("master_url",defaultUrL);console.log("defaultUrL : "+defaultUrL);console.log(rocon_interactions.parameters);if(send_order_pub in rocon_interactions.remappings)
send_order_pub=rocon_interactions.remappings[send_order_pub];console.log(send_order_pub);if(delivery_status_sub_topic in rocon_interactions.remappings)
delivery_status_sub_topic=rocon_interactions.remappings[delivery_status_sub_topic];console.log(delivery_status_sub_topic);settingROSCallbacks();function settingROSCallbacks()
{ros.on('connection',function(){console.log("Connected");deliver_order_client=new ROSLIB.Topic({ros:ros,name:send_order_pub,messageType:send_order_pub_type});var delivery_status_listener=new ROSLIB.Topic({ros:ros,name:delivery_status_sub_topic,messageType:delivery_status_sub_type});delivery_status_listener.subscribe(processDeliveryStatusUpdate);});ros.on('error',function(e){console.log("Error!",e);});ros.on('close',function(){console.log("Connection Close!");});};function processDeliveryStatusUpdate(data){var current_order_id=sym.getVariable("order_id");if(data.order_id==current_order_id){switch(data.status)
{case 10:sym.getSymbol("progress_status").play();sym.getSymbol("progress_status").$("status_txt").html("YujinRobot Smart Cafe");break;case 20:sym.getSymbol("progress_status").stop(110);sym.getSymbol("progress_status").$("status_txt").html("Robot is going to frontdesk");break;case 30:sym.getSymbol("progress_status").stop(220);sym.getSymbol("progress_status").$("status_txt").html("Arrived at frontdesk");break;case 40:sym.getSymbol("progress_status").stop(330);sym.getSymbol("progress_status").$("status_txt").html("Preparing ordered drink");break;case 51:sym.getSymbol("progress_status").stop(440);sym.getSymbol("progress_status").$("status_txt").html("Robot is going to receiver");break;case 52:sym.getSymbol("progress_status").stop(550);sym.getSymbol("progress_status").$("status_txt").html("Arrived at receiver");break;case 53:sym.getSymbol("progress_status").stop(660);sym.getSymbol("progress_status").$("status_txt").html("Take your order and press robot's green button");break;case 54:sym.getSymbol("progress_status").stop(770);sym.getSymbol("progress_status").$("status_txt").html("Delivery complete");break;case 70:sym.getSymbol("progress_status").stop(880);sym.getSymbol("progress_status").$("status_txt").html("Return to dock");break;case 80:sym.getSymbol("progress_status").stop(1000);sym.getSymbol("progress_status").$("status_txt").html("Return complete");sym.getSymbol("order_btn").$("order_btn_bg")[0].style.backgroundColor="#3c5dd4";sym.setVariable("order_progressing",false);break;case-10:sym.getSymbol("progress_status").stop(110);sym.getSymbol("progress_status").$("status_txt").html("Error");break;}}
else{console.log('other delivery status');console.log(current_order_id);console.log(data.order_id);}};});
//Edge binding end
Symbol.bindElementAction(compId,symbolName,"${order_btn}","click",function(sym,e){var qty=sym.getVariable("total_qty");if(typeof qty!="undefined"){console.log("total qty:"+qty.toString());if(qty>0&&sym.getVariable("order_progressing")==false){var menus=[];menus.push(sym.getVariable("menus"));var order_id=uuid();sym.setVariable("order_id",order_id);var order=new ROSLIB.Message({order_id:order_id,receivers:[{'location':"sw_team",'qty':qty,'menus':menus}]});console.log("send order");console.log(order);deliver_order_client.publish(order);sym.setVariable("order_progressing",true);sym.getSymbol("order_btn").$("order_btn_bg")[0].style.backgroundColor="#c8d1f3";sym.getSymbol("progress_status").$("status_txt").html("Order received.");}}
else{console.log("qty is undefined");}});
//Edge binding end
})("stage");
//Edge symbol end:'stage'

//=========================================================

//Edge symbol: 'menu'
(function(symbolName){})("menu");
//Edge symbol end:'menu'

//=========================================================

//Edge symbol: 'order_btn'
(function(symbolName){})("order_btn");
//Edge symbol end:'order_btn'

//=========================================================

//Edge symbol: 'progress_status'
(function(symbolName){})("progress_status");
//Edge symbol end:'progress_status'
})})(AdobeEdge.$,AdobeEdge,"EDGE-67918046");